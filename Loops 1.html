<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
  <head>
    <title>Loops 1</title>
    <meta name="generator" content="muse.el">
    <meta http-equiv="Content-Type"
          content="text/html; charset=iso-8859-1">
    <style type="text/css">
body {
  background: white; color: black;
  margin-left: 3%; margin-right: 7%;
  line-height: 1.5;
  font-family: Nimbus Sans L, sans;
}

p { margin-top: 1% }
p.verse { margin-left: 3% }

.example { margin-left: 3% }

li { margin: 0.5em 0; }

h2 {
  margin-top: 25px;
  margin-bottom: 0px;
}
h3 { margin-bottom: 0px; }

pre {
  border: 1px solid #ccc;
  margin: 5px;
  padding: 5px;
}

td {
  border-top: 1px solid #ccc;
  border-bottom: 1px solid #ccc;
}

code { color: #bc8f8f; font-weight: bold; }
    </style>
  </head>
  <body>
    <h1>Loops 1</h1>
    <!-- Page published by Emacs Muse begins here -->
<h2>Motivation</h2>

<p class="first">So far our programs have not used any loops. A loop is a repetition of
some section of code. Loops are essential in the common situation
where user input or data determines how many times something should
occur. In other cases, the programmer just wants to save time by
reducing the amount of typing or copy-pasting required, as our first
example below shows.</p>

<p>Consider the simple example of the &quot;bottles of beer&quot; song.  This is
how it goes (as far as I know):</p>

<blockquote>
<p class="quoted">99 bottles of beer on the wall, 99 bottles of beer, take one down,
pass it around, 98 bottles of beer on the wall.</p>
</blockquote>

<blockquote>
<p class="quoted">98 bottles of beer on the wall, 98 bottles of beer, take one down,
pass it around, 97 bottles of beer on the wall.</p>
</blockquote>

<blockquote>
<p class="quoted">97 bottles of beer on the wall, 97 bottles of beer, take one down,
pass it around, 96 bottles of beer on the wall.</p>
</blockquote>

<blockquote>
<p class="quoted">...</p>
</blockquote>

<blockquote>
<p class="quoted">1 bottle of beer on the wall, 1 bottle of beer, take it down, pass
it around, no more bottles of beer on the wall.</p>
</blockquote>

<p>Clearly this is a loop. (But a program that prints these lyrics need
not use loops, since you know it should print 100 lines. You could
just use 100 separate <code>cout</code> statements.  Using a loop, on the
other hand, saves us from such tedium.)</p>

<p>There are many examples of tasks that require loops. An interactive
program that asks the user to input a value, then performs a
computation on that input, then asks the user to input another value,
and so on, until the user decides to quit, must use loops.</p>

<p>In this lecture, we will look at the 99-bottles-of-beer loop and the
interactive program loop.</p>


<h2>Building up to 99 bottles of beer</h2>

<p class="first">In C++, the simplest loop is the <code>while</code> loop. Here is a <code>while</code> loop that
prints the first line of the song, forever and ever (infinitely-many
copies of this same lyric are shown on the screen):</p>

<pre class="src">
<span style="color: #a020f0;">while</span>(<span style="color: #5f9ea0;">true</span>)
{
    cout &lt;&lt; <span style="color: #bc8f8f;">"99 bottles of beer on the wall... "</span>
         &lt;&lt; <span style="color: #bc8f8f;">"pass it around, 98 bottles..."</span>
         &lt;&lt; endl;
}
</pre>

<p>The general format for a &lt;tt&gt;while&lt;/tt&gt; loop is:</p>

<pre class="src">
<span style="color: #a020f0;">while</span>(conditional)
{
    <span style="color: #b22222;">// </span><span style="color: #b22222;">do stuff...
</span>}
</pre>

<p>where <code>conditional</code> is the same kind of conditional used in <code>if</code>
statements. In other words, <code>conditional</code> must be something that is a
<code>bool</code> result.</p>

<p>In an <code>if</code> statement, there is no repetition, so the conditional is only
checked once. In a <code>while</code> loop, on the other hand, the conditional is
checked before the loop begins and after every time the stuff inside
the loop is executed. In other words, first <code>conditional</code> is checked. If
it turns out to be true, then <code>stuff...</code> is executed. Then <code>conditional</code>
is checked again. If it is true, <code>stuff...</code> is executed. And so on,
looping over and over so long as <code>conditional</code> is true. If at some point
<code>conditional</code> is false, then <code>stuff...</code> is not executed and the loop is
finished. Execution resumes after the <code>while</code> loop block (a block starts
with <code>{</code> and ends with <code>}</code>).</p>

<p>We saw a &quot;degenerate&quot; loop earlier. It started with <code>while(true)</code>. A
loop like that never stops because the conditional is always
true. Another degenerate case is <code>while(false)</code>. In this case, since the
conditional is never true, the stuff inside the block never
executes. We will see later that <code>while(true)</code> actually can be useful in
a program, but <code>while(false)</code> is never useful.</p>

<p>A loop can be stopped by two techniques. The first technique will be
discussed now. A loop stops when the conditional is false. Consider
this loop:</p>

<pre class="src">
<span style="color: #a020f0;">while</span>(x != 0)
{
    <span style="color: #b22222;">// </span><span style="color: #b22222;">do stuff...
</span>}
</pre>

<p>This loop is stopped only when <code>x == 0</code> because that is the
only case when the conditional is false. This suggests that somewhere
inside the loop, <code>x</code> has to change such that, eventually, <code>x</code> is given the
value <code>0</code>. If that never happens inside the loop, the loop never ends.</p>

<p>Consider the bottles of beer again. Here is a loop that mostly works:</p>

<pre class="src">
<span style="color: #228b22;">int</span> <span style="color: #b8860b;">n</span> = 99;
<span style="color: #a020f0;">while</span>(n &gt; 0)
{
    cout &lt;&lt; n &lt;&lt; <span style="color: #bc8f8f;">" bottles of beer..."</span>
         &lt;&lt; <span style="color: #bc8f8f;">"take one down..."</span>
         &lt;&lt; (n-1) &lt;&lt; <span style="color: #bc8f8f;">" bottles of beer..."</span>
         &lt;&lt; endl;
    n--;
}
</pre>

<p>See how in that case, the conditional <code>n &gt; 0</code> does eventually become
false, because <code>n</code> is decreased each time the loop executes.</p>

<p>In the last code segment, the final bottles-of-beer lyric is not
handled properly. Here is a fix:</p>

<pre class="src">
<span style="color: #228b22;">int</span> <span style="color: #b8860b;">n</span> = 99;
<span style="color: #a020f0;">while</span>(n &gt; 1)
{
    cout &lt;&lt; n &lt;&lt; <span style="color: #bc8f8f;">" bottles of beer..."</span>
         &lt;&lt; <span style="color: #bc8f8f;">"take one down..."</span>
         &lt;&lt; (n-1) &lt;&lt; <span style="color: #bc8f8f;">" bottles of beer..."</span>
         &lt;&lt; endl;
    n--;
}
cout &lt;&lt; <span style="color: #bc8f8f;">"1 bottle of beer ..."</span> &lt;&lt; endl;
</pre>

<p>The last case, when <code>n == 1</code>, is special so we put it
outside the loop.</p>


<h2>What's really happening</h2>

<p class="first">The <code>while()</code> loop is basically converted into an <code>if</code> and <code>goto</code>
statement. For example, this loop:</p>

<pre class="src">
<span style="color: #228b22;">int</span> <span style="color: #b8860b;">x</span> = 0;
<span style="color: #a020f0;">while</span>(x &lt; 10)
{
    cout &lt;&lt; <span style="color: #bc8f8f;">"blah"</span>;
    x++;
}
</pre>

<p>becomes this code:</p>

<pre class="src">
<span style="color: #228b22;">int</span> <span style="color: #b8860b;">x</span> = 0;
<span style="color: #a020f0;">if</span>(x &lt; 10)      <span style="color: #b22222;">// </span><span style="color: #b22222;">name this line of code "CHECK"
</span>{
    cout &lt;&lt; <span style="color: #bc8f8f;">"blah"</span>;
    x++;
    <span style="color: #a020f0;">goto</span> <span style="color: #5f9ea0;">CHECK</span>; <span style="color: #b22222;">// </span><span style="color: #b22222;">here is the "loop" action
</span>}
</pre>


<h2>Interactive program</h2>

<p class="first">The following program repeated asks the user for a letter; if the user
ever types &quot;q&quot; then the program is done.</p>

<pre class="src">
<span style="color: #228b22;">char</span> <span style="color: #b8860b;">c</span>;
cout &lt;&lt; <span style="color: #bc8f8f;">"Enter a letter, 's' to skip the message, 'q' to quit: "</span>;
cin &gt;&gt; c;
<span style="color: #a020f0;">while</span>(c != <span style="color: #bc8f8f;">'q'</span>)
{
    <span style="color: #a020f0;">if</span>(c != <span style="color: #bc8f8f;">'s'</span>)
    {
        cout &lt;&lt; <span style="color: #bc8f8f;">"You typed "</span> &lt;&lt; c &lt;&lt; endl;
    }
    cout &lt;&lt; <span style="color: #bc8f8f;">"Enter a letter, 's' to skip the message, 'q' to quit: "</span>;
    cin &gt;&gt; c;
}
</pre>

<p>This program is better written with a <code>do-while</code> loop because we want
the <code>cout</code> and <code>cin</code> pair to be done even before the check. Here it is
with <code>do-while</code>:</p>

<pre class="src">
<span style="color: #228b22;">char</span> <span style="color: #b8860b;">c</span>;
<span style="color: #a020f0;">do</span>
{
    cout &lt;&lt; <span style="color: #bc8f8f;">"Enter a letter, 's' to skip the message, 'q' to quit: "</span>;
    cin &gt;&gt; c;

    <span style="color: #a020f0;">if</span>(c != <span style="color: #bc8f8f;">'s'</span> &amp;&amp; c != <span style="color: #bc8f8f;">'q'</span>)
    {
        cout &lt;&lt; <span style="color: #bc8f8f;">"You typed "</span> &lt;&lt; c &lt;&lt; endl;
    }
} <span style="color: #a020f0;">while</span>(c != <span style="color: #bc8f8f;">'q'</span>);
</pre>


<h2>Diagram of while() loop (and for() loop)</h2>

<p class="image"><img src="loops-diagram.png" alt=""></p>


<h2>Readings (not required)</h2>

<ul>
<li>Textbook (Etter &amp; Ingber): pp 97-99</li>

<li>cplusplus.com: <a href="http://www.cplusplus.com/doc/tutorial/control/">Control structures</a> (middle of page)</li>

<li>learncpp.com: <a href="http://www.learncpp.com/cpp-tutorial/55-while-statements/">while statements</a>; <a href="http://www.learncpp.com/cpp-tutorial/56-do-while-statements/">do-while statements</a></li>

<li>Teach yourself C++ in 21 days: <a href="http://newdata.box.sk/bx/c/htm/ch07.htm">More program flow</a> (first half)</li>

<li>Learning C++: <a href="http://www.isotton.com/devel/docs/lcpp/unpacked/node8.html">Loops</a> (first half)</li>

<li>Videos: <a href="http://xoax.net/comp/cpp/console/Lesson8.php">while and do-while loops</a></li>
</ul>



<!-- Page published by Emacs Muse ends here -->
  </body>
</html>
